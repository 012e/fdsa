schema {
  query: Query
  mutation: Mutation
}

input CloneRepositoryInput {
  description: String
  identifier: String!
  sourceUrl: String!
}

type Mutation {
  addRepositoryFile(input: RepositoryFileChangeInput!): Boolean!
  cloneRepository(input: CloneRepositoryInput!): Repository!
  createRepository(input: RepositoryInput!): Repository!
  createRepositoryFolder(input: RepositoryPathChangeInput!): Boolean!
  createSnippet(snippet: SnippetInput): Snippet!
  deleteRepositoryFile(input: RepositoryPathChangeInput!): Boolean!
  deleteRepositoryFolder(input: RepositoryPathChangeInput!): Boolean!
  deleteSnippet(id: ID!): Boolean!
  updateRepositoryFile(input: RepositoryFileChangeInput!): Boolean!
  updateSnippet(id: ID!, snippet: SnippetInput): Snippet!
}

type Query {
  listFilesByPath(owner: String!, path: String!): [SnippetFile!]!
  repositories: [Repository!]!
  repositoriesByOwner(owner: String!): [Repository!]!
  repository(identifier: String!): Repository!
  snippetById(id: ID!): Snippet!
  snippetByPath(owner: String!, path: String!): Snippet!
  snippets: [Snippet!]!
  snippetsByOwner(owner: String!): [Snippet!]!
}

"""Code repository backed by the repository service"""
type Repository {
  description: String
  filesystemPath: String!
  identifier: String!
}

input RepositoryFileChangeInput {
  commitMessage: String!
  content: String!
  encoding: RepositoryFileEncoding = TEXT
  path: String!
  repositoryId: ID!
}

enum RepositoryFileEncoding {
  BASE64
  TEXT
}

input RepositoryInput {
  description: String
  identifier: String!
}

input RepositoryPathChangeInput {
  commitMessage: String!
  path: String!
  repositoryId: ID!
}

type Snippet {
  code: String!
  id: ID!
  owner: String!
  path: String!
}

type SnippetFile {
  id: ID
  isDirectory: Boolean!
  owner: String!
  path: String!
}

input SnippetInput {
  code: String!
  owner: String!
  path: String!
}